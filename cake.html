<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéÇ Cake Cutting Ceremony üéâ</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: radial-gradient(circle at top, #ffb6c1, #ff69b4, #c71585);
      font-family: 'Poppins', sans-serif;
      text-align: center;
      color: white;
    }

    h1 {
      margin-top: 5vh;
      font-size: 3em;
      animation: glow 2s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 0 10px #fff, 0 0 20px #ff69b4; }
      to { text-shadow: 0 0 20px #fff, 0 0 40px #ff1493; }
    }

    .cake-container {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 40px;
      margin-top: 50px;
      padding-top: 70px;
      position: relative; /* For the main cake, to position slices */
    }

    /* === REVISED CAKE CSS FOR SLICES === */
    .cake {
      width: 180px;
      height: 130px;
      background: #ffccdd; /* light pink cake base */
      border-radius: 15px;
      position: relative;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2), 
                  0 0 20px rgba(255, 255, 255, 0.6);
      cursor: pointer;
      transition: transform 0.3s;
      animation: floaty 4s ease-in-out infinite alternate;
      /* Ensure default cake is not hidden */
      z-index: 1; 
    }

    /* NEW: Styles for the photo placeholders */
    /* REMOVED: .photo-placeholder styles */
    /* REMOVED: .photo-placeholder:hover styles */
    /* REMOVED: .placeholder-text styles */
    /* REMOVED: .placeholder-text span styles */

    .cake:hover {
      transform: scale(1.05);
    }
    
    /* Base styling for all cake parts (whole cake and slices) */
    .cake-part {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 15px;
        background: #ffccdd; /* Base cake color */
    }

    .cake-part::before { /* Icing */
        content: '';
        position: absolute;
        top: -10px;
        left: 0;
        width: 100%;
        height: 50px;
        background: #ff69b4;
        border-radius: 15px;
    }

    .cake-part::after { /* Filling */
        content: '';
        position: absolute;
        top: 60px;
        left: 0;
        width: 100%;
        height: 6px;
        background: #b03060;
    }

    /* Styles for the "main" cake which now holds the slices */
    #mainCake {
        cursor: pointer;
        transition: none; /* No hover scale on the main container */
        animation: none; /* No floaty on the main container */
        position: relative; /* Allows positioning of slices within */
        width: 180px;
        height: 130px;
        box-shadow: none; /* The slices will cast shadows */
        background: transparent; /* Main container is invisible */
    }

    /* Individual slices styling */
    .cake-slice-left, .cake-slice-right {
        position: absolute;
        top: 0;
        width: 90px; /* Half of cake width */
        height: 100%;
        overflow: hidden; /* Hide excess */
        transition: transform 0.5s ease-out, opacity 0.5s ease-out;
        opacity: 0;
        z-index: 5;
    }

    .cake-slice-left {
        left: 0;
        border-radius: 15px 0 0 15px;
        transform-origin: 100% center; /* Pivot from the right edge */
        transform: translateX(-5px) rotateY(-5deg); /* Initial slight separation */
    }

    .cake-slice-right {
        right: 0;
        border-radius: 0 15px 15px 0;
        transform-origin: 0% center; /* Pivot from the left edge */
        transform: translateX(5px) rotateY(5deg); /* Initial slight separation */
    }

    /* Inner part of the slice (applies the cake appearance) */
    .cake-slice-left .cake-part {
        left: 0; /* Keep the content aligned left */
        border-radius: 15px 0 0 15px;
    }
    .cake-slice-right .cake-part {
        right: 0; /* Keep the content aligned right */
        border-radius: 0 15px 15px 0;
    }

    /* What the slices look like *after* the cut */
    .cake-slice-left.cut {
        opacity: 1;
        transform: translateX(-30px) rotateY(-10deg) rotateX(5deg);
    }
    .cake-slice-right.cut {
        opacity: 1;
        transform: translateX(30px) rotateY(10deg) rotateX(-5deg);
    }


    /* Candle and flame styles (for all cakes) */
    .candles {
      position: absolute;
      top: -50px;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: space-around;
      z-index: 10;
    }

    .candle {
      width: 10px;
      height: 40px;
      background: repeating-linear-gradient(
          45deg,
          #ff69b4,
          #ff69b4 5px,
          #ffffff 5px,
          #ffffff 10px
      );
      border-radius: 5px;
      position: relative;
    }

    .candle::before { /* Wick */
      content: '';
      position: absolute;
      top: -5px;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 5px;
      background: #333;
    }

    .flame {
      width: 10px;
      height: 15px;
      background: radial-gradient(circle, yellow, orange, red);
      border-radius: 50% 50% 50% 0 / 60% 60% 40% 40%;
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      animation: flicker 0.2s infinite alternate;
      transform-origin: bottom;
    }
    /* === END OF REVISED CAKE CSS === */


    @keyframes floaty {
      from { transform: translateY(0); }
      to { transform: translateY(-15px); }
    }
    
    @keyframes flicker {
      from { transform: translateX(-50%) scale(1); opacity: 1; }
      to { transform: translateX(-50%) scale(1.3); opacity: 0.8; }
    }

    .knife {
      position: absolute;
      top: -60px; /* Start above the cake */
      left: 50%; /* Center initially */
      transform: translateX(-50%) rotate(45deg); /* Initial rotation */
      width: 100px;
      height: 10px;
      background: silver;
      border-radius: 3px;
      display: none;
      z-index: 20; /* Ensure knife is above cake */
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    #cut-text {
      display: none;
      font-size: 2em;
      margin-top: 40px;
      animation: pop 1s ease forwards;
    }

    @keyframes pop {
      0% { transform: scale(0); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
    }
    
    .back-link {
        color: white; 
        text-decoration: none; 
        font-weight: bold; 
        background: #ff1493; 
        padding: 10px 20px; 
        border-radius: 20px; 
        display: inline-block; 
        margin-top: 15px;
        transition: background 0.3s;
    }
    .back-link:hover {
        background: #c71585;
    }

    /* NEW: Floating hearts */
    .heart {
      position: fixed;
      bottom: 0;
      font-size: 20px;
      color: #ffb6c1;
      animation: floatUp 6s linear infinite;
      opacity: 0.8;
    }

    @keyframes floatUp {
      from { transform: translateY(0) scale(1); opacity: 1; }
      to { transform: translateY(-100vh) scale(1.5); opacity: 0; }
    }

    /* NEW: Floating balloons */
    .balloon {
      position: fixed;
      bottom: -100px;
      width: 50px;
      height: 70px;
      border-radius: 50% 50% 45% 45%;
      background: radial-gradient(circle at 30% 30%, #fff, #ff69b4);
      animation: floatBalloon 10s linear infinite;
    }

    @keyframes floatBalloon {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(-120vh); opacity: 0; }
    }

  </style>
</head>
<body>
  <canvas id="confetti"></canvas>

  <h1>üéÇ Let‚Äôs Cut the Cake! üéâ</h1>

  <div class="cake-container">
    <!-- Decorative cakes REPLACED with photo placeholders -->
    <!-- REMOVED: Photo placeholder -->
    <!-- REMOVED: Photo placeholder -->

    <!-- Main cake (clickable) - now it's a container for slices --><div id="mainCake">
        <!-- NEW: Add a visual for the whole cake before it's cut -->
        <div class="cake-part" id="wholeCakeVisual"></div>

        <!-- The slices start hidden and move apart --><div class="cake-slice-left" id="cakeSliceLeft">
            <div class="cake-part"></div>
        </div>
        <div class="cake-slice-right" id="cakeSliceRight">
            <div class="cake-part"></div>
        </div>

        <!-- Candles sit on top of where the full cake would be --><div class="candles" id="mainCandles">
            <div class="candle"><div class="flame"></div></div>
            <div class="candle"><div class="flame"></div></div>
            <div class="candle"><div class="flame"></div></div>
        </div>
        <div class="knife" id="knife"></div>
    </div>

    <!-- More decorative cakes REPLACED with photo placeholders -->
    <!-- REMOVED: Photo placeholder -->
    <!-- REMOVED: Photo placeholder -->
  </div>

  <div id="cut-text">üíñ Happy Birthday, My Love! üíñ</div>

 <a href="birthday_wish.html" class="back-link">üç∞ Back to Main Menu</a>


  <audio id="song" src="https://rr2---sn-cvh76nl6.googlevideo.com/videoplayback?expire=1763142736&ei=8BcXabOjJJfMi9oPku_yyAM&ip=197.204.184.72&id=o-AOSRTW9Ev9MpPiqATVFAlkJyZHxAxaBgtNkY-yPVEzVW&itag=140&source=youtube&requiressl=yes&xpc=EgVo2aDSNQ%3D%3D&cps=100&bui=AdEuB5T5xritr3EaIv5KzQbiKJbCJMkJ4FjjNRw-wfNiK-LhpDoFV4K2WiVOmr8ZgV2IgaA3uDmFh76i&vprv=1&svpuc=1&mime=audio%2Fmp4&ns=-IE-Pfti2Os_TXicAQWnoP0Q&rqh=1&gir=yes&clen=12563787&dur=776.266&lmt=1741358687710821&keepalive=yes&lmw=1&fexp=51557447,51565115,51565682,51580970&c=TVHTML5&sefc=1&txp=5318224&n=ODJabVtWw-pq3A&sparams=expire%2Cei%2Cip%2Cid%2Citag%2Csource%2Crequiressl%2Cxpc%2Cbui%2Cvprv%2Csvpuc%2Cmime%2Cns%2Crqh%2Cgir%2Cclen%2Cdur%2Clmt&sig=AJfQdSswRQIhALGCL9DJb4uPpTjdz0RZktK5PetEErIGVTqH61Wfc6WsAiBV9aP_FCYVxdkrps4-b--0MLFDyVzHlN5gEw36JQd15w%3D%3D&rm=sn-5abxgpxuxaxjvh-vbme7s,sn-hpa6d7e&rrc=79,104,191&req_id=64f65fb201cba3ee&rms=rdu,au&ipbypass=yes&redirect_counter=3&cm2rm=sn-ci5gup-cvhes7e&cms_redirect=yes&cmsv=e&met=1763121163,&mh=af&mip=2401:4900:c0b7:4e1d:46:113:6134:df70&mm=30&mn=sn-cvh76nl6&ms=nxu&mt=1763120447&mv=m&mvi=2&pl=44&lsparams=cps,ipbypass,met,mh,mip,mm,mn,ms,mv,mvi,pl,rms&lsig=APaTxxMwRQIhAK2U1RqWqiHhfjbAuRaUL4jdEpWmSpyr57danatEvkukAiAY-V1_2xDTRZvUhfQvamMthKLSLf8MDOVZ72l_n_y5Zw%3D%3D"></audio>

  <script>
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    canvas.width = innerWidth;
    canvas.height = innerHeight;

    let confetti = [];
    let cutConfetti = []; // NEW: Separate array for the "cut" burst

    class Confetti {
      constructor(x, y, color) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.size = Math.random() * 8 + 2;
        this.speedY = Math.random() * 3 + 1;
        this.speedX = Math.random() * 2 - 1;
      }
      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
      }
      update() {
        this.y += this.speedY;
        this.x += this.speedX;
        if (this.y > canvas.height + this.size) {
            this.y = 0 - this.size; // Reset just above the screen
            this.x = Math.random() * canvas.width; // Re-randomize x
        }
        if (this.x > canvas.width + this.size) this.x = 0 - this.size;
        if (this.x < 0 - this.size) this.x = canvas.width + this.size;
      }
    }
    
    // RENAMED: This is for the continuous floating confetti
    function animateFloatingConfetti() {
      // Clear only a fraction for a trailing effect
      ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      for (let c of confetti) {
        c.update();
        c.draw();
      }
      
      // NEW: Draw the burst confetti if it exists
      for (let i = cutConfetti.length - 1; i >= 0; i--) {
          cutConfetti[i].update();
          cutConfetti[i].draw();
          cutConfetti[i].size *= 0.98; // Shrink burst confetti
          if (cutConfetti[i].size < 0.5) {
              cutConfetti.splice(i, 1);
          }
      }
      
      requestAnimationFrame(animateFloatingConfetti);
    }
    
    // RENAMED: This creates the initial floating confetti
    function makeFloatingConfetti() {
      for (let i = 0; i < 200; i++) {
        const x = Math.random() * canvas.width;
        const y = Math.random() * canvas.height; // Start all over the screen
        const color = `hsl(${Math.random() * 360}, 100%, 70%)`;
        confetti.push(new Confetti(x, y, color));
      }
    }
    
    // NEW: This is the burst confetti, called on cut
    function makeBurstConfetti() {
        const cakeRect = mainCake.getBoundingClientRect();
        const burstX = cakeRect.left + cakeRect.width / 2;
        const burstY = cakeRect.top + cakeRect.height / 2;
        
        for (let i = 0; i < 100; i++) {
            const color = `hsl(${Math.random() * 360}, 100%, 70%)`;
            let burstParticle = new Confetti(burstX, burstY, color);
            // Give it a much faster, more explosive speed
            burstParticle.speedY = Math.random() * -10 - 5; // Upwards
            burstParticle.speedX = Math.random() * 20 - 10; // All directions
            burstParticle.size = Math.random() * 10 + 4;
            // Add gravity
            burstParticle.update = function() {
                this.y += this.speedY;
                this.x += this.speedX;
                this.speedY += 0.3; // Gravity
            };
            cutConfetti.push(burstParticle);
        }
    }

    const mainCake = document.getElementById('mainCake');
    const mainCandles = document.getElementById('mainCandles');
    const knife = document.getElementById('knife');
    const cutText = document.getElementById('cut-text');
    const song = document.getElementById('song');
    const cakeSliceLeft = document.getElementById('cakeSliceLeft');
    const cakeSliceRight = document.getElementById('cakeSliceRight');
    <!-- NEW: Get the whole cake visual element -->
    const wholeCakeVisual = document.getElementById('wholeCakeVisual');

    let cut = false;

    mainCake.addEventListener('click', () => {
      if (cut) return;
      cut = true;
      mainCandles.style.display = 'none'; 
      knife.style.display = 'block';

      // Animate knife down and then out
      knife.animate([
        { top: '-60px', left: '50%', transform: 'translateX(-50%) rotate(45deg)' },
        { top: '60px', left: '50%', transform: 'translateX(-50%) rotate(45deg)' } // Knife goes through cake
      ], { duration: 500, easing: 'ease-in-out', fill: 'forwards' }).onfinish = () => {

        wholeCakeVisual.style.display = 'none';

        cakeSliceLeft.classList.add('cut');
        cakeSliceRight.classList.add('cut');

        knife.animate([
            { top: '60px', left: '50%', transform: 'translateX(-50%) rotate(45deg)' },
            { top: '150px', left: '0%', transform: 'translateX(-100%) rotate(0deg)' } // Knife exits bottom-left
        ], { duration: 700, easing: 'ease-in', fill: 'forwards' }).onfinish = () => {
            knife.style.display = 'none';
            cutText.style.display = 'block';
            song.play().catch(e => console.log("Song play failed:", e));
            // CHANGED: Call the burst confetti
            makeBurstConfetti();
            // We don't need to call animateConfetti, it's already running
        };
      };
    });

    // NEW: Create floating hearts
    function createHeart() {
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.textContent = 'üíñ';
      heart.style.left = Math.random() * 100 + 'vw';
      heart.style.animationDuration = Math.random() * 3 + 4 + 's';
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 6000);
    }

    // NEW: Create floating balloons
    function createBalloon() {
      const balloon = document.createElement('div');
      balloon.className = 'balloon';
      balloon.style.left = Math.random() * 100 + 'vw';
      balloon.style.background = `radial-gradient(circle at 30% 30%, #fff, hsl(${Math.random() * 360}, 100%, 70%))`;
      balloon.style.animationDuration = 8 + Math.random() * 4 + 's';
      document.body.appendChild(balloon);
      setTimeout(() => balloon.remove(), 10000);
    }

    window.addEventListener('resize', () => {
      canvas.width = innerWidth;
      canvas.height = innerHeight;
    });
    
    // --- NEW: Start all background animations on load ---
    makeFloatingConfetti();
    animateFloatingConfetti();
    setInterval(createHeart, 500);
    setInterval(createBalloon, 1500);
    
  </script>
</body>
</html>